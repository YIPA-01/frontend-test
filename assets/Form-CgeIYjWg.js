import{B as E,k as N,e as $,c as G,o as d,w as r,a as o,b as a,u as i,l as c,t as p,m as D,d as u,i as f,n as j,G as U,F as C,j as V,p as J}from"./main-MNcEe9nS.js";import{b}from"./useToast-D-yC0XMS.js";import{_ as K}from"./Card-CGGVAz6J.js";import{_ as O,a as q}from"./CardTitle-CvEajrma.js";import{_ as H}from"./CardContent-DjNJdOrj.js";import{_ as L}from"./CardFooter-C_kW6sXe.js";import{_ as y,a as w}from"./Label-Bj1JoglS.js";import{_ as R}from"./Switch-CiQvMZNC.js";import{_ as W}from"./Textarea-IE4nHqzy.js";const Q={class:"space-y-2"},X={key:0,class:"text-sm text-destructive"},Y={class:"space-y-2"},Z={key:0,class:"text-sm text-destructive"},ee={class:"space-y-4"},te={class:"flex gap-2"},se={key:0,class:"flex flex-wrap gap-2"},ie=["onClick"],oe={key:1,class:"text-sm text-destructive"},ae={class:"space-y-4"},le={key:0,class:"space-y-2"},re={class:"grid grid-cols-2 md:grid-cols-3 gap-4"},ne={class:"aspect-video bg-muted rounded-lg flex items-center justify-center text-sm text-muted-foreground border-2 border-dashed"},de={class:"text-center p-2"},ce={class:"font-medium truncate"},ue={class:"text-xs"},me={key:1,class:"space-y-2"},pe={class:"grid grid-cols-2 md:grid-cols-3 gap-4"},ge=["src","alt"],ve={class:"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity rounded-lg flex items-center justify-center"},_e={class:"flex gap-2"},fe={key:2,class:"text-sm text-destructive"},ye={class:"space-y-4"},he={class:"flex items-center justify-between space-x-2"},be={class:"space-y-0.5"},xe={key:0,class:"text-sm text-destructive"},Fe={__name:"Form",props:{mode:{type:String,required:!0,validator:g=>["create","edit"].includes(g)},project:{type:Object,default:()=>({title:"",description:"",technologies:[],is_visible:!0,images:[]})}},setup(g){const v=g,P=E(),x=J(),t=N({title:v.project.title||"",description:v.project.description||"",technologies:v.project.technologies||[],is_visible:!!(v.project.is_visible??!0),images:[]}),n=$({}),k=$(!1),h=$(""),S=()=>{h.value.trim()&&!t.technologies.includes(h.value.trim())&&(t.technologies.push(h.value.trim()),h.value="")},I=m=>{t.technologies.splice(m,1)},F=m=>{const e=Array.from(m.target.files);console.log("Selected files:",e),t.images=e},T=m=>{const e=Array.from(t.images);e.splice(m,1),t.images=e},A=async m=>{if(v.mode==="edit")try{await x.put(`/admin/projects/${v.project.id}/images/${m}/set-main`),console.log("Main image updated")}catch(e){console.error("Failed to set main image:",e)}},B=async m=>{if(v.mode==="edit"&&confirm("Are you sure you want to delete this image?"))try{await x.delete(`/admin/projects/${v.project.id}/images/${m}`),console.log("Image deleted")}catch(e){console.error("Failed to delete image:",e)}},M=async()=>{var m,e;console.log("Submitting form with data:",{title:t.title,description:t.description,technologies:t.technologies,is_visible:t.is_visible,images:t.images,imageCount:t.images.length}),t.images.length>0&&t.images.forEach((l,s)=>{console.log(`Image ${s+1}:`,{name:l.name,size:l.size,type:l.type})}),k.value=!0,n.value={};try{const l=new FormData;l.append("title",t.title),l.append("description",t.description),l.append("technologies",JSON.stringify(t.technologies)),l.append("is_visible",t.is_visible?"1":"0"),t.images.length>0&&t.images.forEach((s,_)=>{l.append(`images[${_}]`,s)}),v.mode==="create"?(await x.post("/admin/projects",l,{headers:{"Content-Type":"multipart/form-data"}}),console.log("Project created successfully"),P.push("/admin/projects")):(l.append("_method","PATCH"),await x.post(`/admin/projects/${v.project.id}`,l,{headers:{"Content-Type":"multipart/form-data"}}),console.log("Project updated successfully"),P.push("/admin/projects"))}catch(l){console.error("Form submission errors:",l),(e=(m=l.response)==null?void 0:m.data)!=null&&e.errors&&(n.value=l.response.data.errors)}finally{k.value=!1}};return(m,e)=>(d(),G(i(K),null,{default:r(()=>[o(i(O),null,{default:r(()=>[o(i(q),null,{default:r(()=>[c(p(g.mode==="create"?"Add New Project":"Edit Project"),1)]),_:1})]),_:1}),a("form",{onSubmit:D(M,["prevent"])},[o(i(H),{class:"space-y-6"},{default:r(()=>{var l;return[a("div",Q,[o(i(y),{for:"title"},{default:r(()=>e[4]||(e[4]=[c("Title")])),_:1,__:[4]}),o(i(w),{id:"title",modelValue:t.title,"onUpdate:modelValue":e[0]||(e[0]=s=>t.title=s),type:"text",placeholder:"Enter project title",class:j({"border-destructive ring-destructive":n.value.title})},null,8,["modelValue","class"]),n.value.title?(d(),u("p",X,p(n.value.title[0]),1)):f("",!0)]),a("div",Y,[o(i(y),{for:"description"},{default:r(()=>e[5]||(e[5]=[c("Description")])),_:1,__:[5]}),o(i(W),{id:"description",modelValue:t.description,"onUpdate:modelValue":e[1]||(e[1]=s=>t.description=s),placeholder:"Enter project description",rows:"4",class:j({"border-destructive ring-destructive":n.value.description})},null,8,["modelValue","class"]),n.value.description?(d(),u("p",Z,p(n.value.description[0]),1)):f("",!0)]),a("div",ee,[o(i(y),null,{default:r(()=>e[6]||(e[6]=[c("Technologies")])),_:1,__:[6]}),a("div",te,[o(i(w),{modelValue:h.value,"onUpdate:modelValue":e[2]||(e[2]=s=>h.value=s),type:"text",placeholder:"Add a technology",onKeyup:U(S,["enter"]),class:"flex-1"},null,8,["modelValue"]),o(i(b),{type:"button",variant:"outline",onClick:S},{default:r(()=>e[7]||(e[7]=[c(" Add ")])),_:1,__:[7]})]),t.technologies.length>0?(d(),u("div",se,[(d(!0),u(C,null,V(t.technologies,(s,_)=>(d(),u("span",{key:_,class:"inline-flex items-center gap-1 rounded-full bg-primary/10 px-3 py-1 text-sm text-primary"},[c(p(s)+" ",1),a("button",{type:"button",onClick:z=>I(_),class:"ml-1 hover:text-destructive"}," × ",8,ie)]))),128))])):f("",!0),n.value.technologies?(d(),u("p",oe,p(n.value.technologies[0]),1)):f("",!0)]),a("div",ae,[o(i(y),{for:"images"},{default:r(()=>e[8]||(e[8]=[c("Project Images")])),_:1,__:[8]}),o(i(w),{id:"images",type:"file",multiple:"",accept:"image/*",onChange:F,class:j({"border-destructive ring-destructive":n.value.images})},null,8,["class"]),e[12]||(e[12]=a("p",{class:"text-sm text-muted-foreground"}," Select multiple images for your project. Supported formats: JPEG, PNG, JPG, GIF, SVG, WebP (max 2MB each) ",-1)),t.images.length>0?(d(),u("div",le,[o(i(y),null,{default:r(()=>[c("Selected Images ("+p(t.images.length)+")",1)]),_:1}),a("div",re,[(d(!0),u(C,null,V(t.images,(s,_)=>(d(),u("div",{key:_,class:"relative group"},[a("div",ne,[a("div",de,[a("div",ce,p(s.name),1),a("div",ue,p((s.size/1024/1024).toFixed(2))+"MB",1)])]),o(i(b),{type:"button",variant:"destructive",size:"sm",class:"absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity",onClick:z=>T(_)},{default:r(()=>e[9]||(e[9]=[c(" × ")])),_:2,__:[9]},1032,["onClick"])]))),128))])])):f("",!0),g.mode==="edit"&&((l=g.project.images)==null?void 0:l.length)>0?(d(),u("div",me,[o(i(y),null,{default:r(()=>e[10]||(e[10]=[c("Current Images")])),_:1,__:[10]}),a("div",pe,[(d(!0),u(C,null,V(g.project.images,s=>(d(),u("div",{key:s.id,class:"relative group"},[a("img",{src:s.url,alt:g.project.title,class:"aspect-video object-cover rounded-lg border"},null,8,ge),a("div",ve,[a("div",_e,[o(i(b),{type:"button",variant:"secondary",size:"sm",onClick:_=>A(s.id)},{default:r(()=>[c(p(g.project.main_image_id===s.id?"Main":"Set Main"),1)]),_:2},1032,["onClick"]),o(i(b),{type:"button",variant:"destructive",size:"sm",onClick:_=>B(s.id)},{default:r(()=>e[11]||(e[11]=[c(" Delete ")])),_:2,__:[11]},1032,["onClick"])])])]))),128))])])):f("",!0),n.value.images?(d(),u("p",fe,p(n.value.images[0]),1)):f("",!0)]),a("div",ye,[a("div",he,[a("div",be,[o(i(y),{for:"is_visible"},{default:r(()=>e[13]||(e[13]=[c("Visibility")])),_:1,__:[13]}),e[14]||(e[14]=a("p",{class:"text-sm text-muted-foreground"}," Make this project visible on your portfolio ",-1))]),o(i(R),{id:"is_visible",modelValue:t.is_visible,"onUpdate:modelValue":e[3]||(e[3]=s=>t.is_visible=s),class:j({"ring-destructive":n.value.is_visible})},null,8,["modelValue","class"])]),n.value.is_visible?(d(),u("p",xe,p(n.value.is_visible[0]),1)):f("",!0)])]}),_:1}),o(i(L),{class:"flex justify-end space-x-2"},{default:r(()=>[o(i(b),{type:"submit",disabled:k.value},{default:r(()=>[c(p(g.mode==="create"?"Create Project":"Update Project"),1)]),_:1},8,["disabled"])]),_:1})],32)]),_:1}))}};export{Fe as _};
